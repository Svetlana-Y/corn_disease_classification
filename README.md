# üåΩ –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –±–æ–ª–µ–∑–Ω–µ–π –ª–∏—Å—Ç—å–µ–≤ –∫—É–∫—É—Ä—É–∑—ã - corn_disease_classification

---

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ö—É–∫—É—Ä—É–∑–∞ ‚Äî –æ–¥–Ω–∞ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä –≤ –º–∏—Ä–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –∫–∞–∫ –≤ –ø–∏—â–µ–≤–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∏ –≤ –∂–∏–≤–æ—Ç–Ω–æ–≤–æ–¥—Å—Ç–≤–µ. –û–¥–Ω–∞–∫–æ –µ—ë —É—Ä–æ–∂–∞–π–Ω–æ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç—Å—è –∏–∑-–∑–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ª–∏—Å—Ç—å–µ–≤, —Ç–∞–∫–∏—Ö –∫–∞–∫:

- üåæ –û–±—ã–∫–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–∂–∞–≤—á–∏–Ω–∞
- üçÇ –°–µ—Ä–∞—è –ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å –ª–∏—Å—Ç—å–µ–≤
- üå± –§–∏—Ç–æ—Ñ—Ç–æ—Ä–æ–∑ –ª–∏—Å—Ç—å–µ–≤

–†–∞–Ω–Ω–µ–µ –∏ —Ç–æ—á–Ω–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ —ç—Ç–∏—Ö –±–æ–ª–µ–∑–Ω–µ–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å —É—Ä–æ–∂–∞—è –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø—Ä–æ–¥–æ–≤–æ–ª—å—Å—Ç–≤–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±–æ–ª–µ–∑–Ω–µ–π –ª–∏—Å—Ç—å–µ–≤ –∫—É–∫—É—Ä—É–∑—ã –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

---

## üìä –î–∞–Ω–Ω—ã–µ

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

- https://www.kaggle.com/datasets/ulaelg/corn-leaf-disease-data
- https://www.kaggle.com/datasets/smaranjitghose/corn-or-maize-leaf-disease-dataset

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞

- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π**
- –†–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤–∞—Ä—å–∏—Ä—É—é—Ç—Å—è –æ—Ç **256√ó256 –¥–æ 3264√ó2448**
- –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ü–≤–µ—Ç–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (RGB, CMYK, MGBA)
- **–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤**:
  - –û–±—ã–∫–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–∂–∞–≤—á–∏–Ω–∞ ‚Äî ~1306 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  - –°–µ—Ä–∞—è –ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å –ª–∏—Å—Ç—å–µ–≤ ‚Äî ~574 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–í—Å–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏.

---

## üß† –ú–æ–¥–µ–ª–∏

### –ë–µ–π–∑–ª–∞–π–Ω

- **RexNet (pretrained)**
- Accuracy ‚âà **0.85**

---

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏

#### RexNet

RexNet ‚Äî —ç—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

- –ª–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç –∫–∞–Ω–∞–ª–æ–≤
- –∞–∫—Ç–∏–≤–∞—Ü–∏—è **PReLU**
- –º–µ–Ω—å—à–µ–µ —á–∏—Å–ª–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã—Ö —Ä–µ—à–µ–Ω–∏–π

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ª–∏—Å—Ç—å–µ–≤ –∫—É–∫—É—Ä—É–∑—ã.

---

#### Vision Transformer (ViT)

ViT ‚Äî –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä–∞—è:

- —Ä–∞–∑–±–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø–∞—Ç—á–∏
- –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ self-attention
- –∞–¥–∞–ø—Ç–∏–≤–Ω–æ —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –≤–∞–∂–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ª—É—á—à—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (attention maps)

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:

- **Accuracy** ‚Äî –æ–±—â–∞—è –¥–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- **Precision** ‚Äî —Å–Ω–∏–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (FP)
- **Recall** ‚Äî –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–ø—É—Å–∫ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π (FN)
- **F1-score** ‚Äî —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞

### –¶–µ–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

- Recall > **0.8**
- F1-score ‚âà **0.8‚Äì0.9**

---

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
corn_disease_classification/
‚îÇ
‚îú‚îÄ‚îÄ configs/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Hydra
‚îÇ   ‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ default.yaml
‚îÇ   ‚îú‚îÄ‚îÄ infer/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ default.yaml
‚îÇ   ‚îî‚îÄ‚îÄ export/
‚îÇ       ‚îî‚îÄ‚îÄ default.yaml
‚îÇ
‚îú‚îÄ‚îÄ corn_classifier/        # –û—Å–Ω–æ–≤–Ω–æ–π Python-–ø–∞–∫–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ data/               # –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dataset.py      # Dataset –∏ DataLoader
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ download.py     # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ models/             # –ú–æ–¥–µ–ª–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ archs.py        # RexNet, ViT –∏ –¥—Ä.
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lit_model.py    # Lightning-–º–æ–¥–µ–ª—å
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ train.py            # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ infer.py            # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
‚îÇ   ‚îú‚îÄ‚îÄ export.py           # –≠–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ commands.py         # CLI-–∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ utils.py            # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ
‚îú‚îÄ‚îÄ data/                   # –î–∞–Ω–Ω—ã–µ (DVC)
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ trt_convert.sh      # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ TensorRT
‚îÇ
‚îú‚îÄ‚îÄ dvc.yaml                # DVC pipeline
‚îÇ
‚îú‚îÄ‚îÄ pyproject.toml          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ uv.lock                 # Lock-—Ñ–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îÇ
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îî‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

### Setup

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
git clone https://github.com/Svetlana-Y/corn_disease_classification.git
cd corn_disease_classification
```

2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ:

```bash
python -m venv .venv
source .venv/bin/activate
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å uv (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):

```bash
pip install --upgrade pip
pip install uv
```

4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
uv pip install -e .
```

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ
```
uv pip install ".[dev]"
```

5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å pre-commit —Ö—É–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ö:

```bash
pre-commit install
pre-commit run -a
```

6. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (–ª–∏–±–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ train):

- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ dvc credentials: –ø–æ–ª–æ–∂–∏—Ç–µ `dvc_credentials.json` (JSON —Å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º Service Account) –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞.
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
dvc pull
```

- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Kaggle credentials: –ø–æ–ª–æ–∂–∏—Ç–µ `kaggle.json` –≤ `~/.kaggle/kaggle.json` (–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∞ kaggle.com).
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
python -c "from corn_classifier.data.download import download_data; download_data()"
```

## mlflow

–ó–∞–ø—É—Å–∫ MLflow-—Å–µ—Ä–≤–µ—Ä–∞ (–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)

```bash
mlflow server
    --backend-store-uri file:./mlruns
    --default-artifact-root file:./mlartifacts
    --host 127.0.0.1
    --port 5000
```

MLflow –æ–∂–∏–¥–∞–µ—Ç—Å—è –ø–æ –∞–¥—Ä–µ—Å—É `http://127.0.0.1:5000` ‚Äî –µ—Å–ª–∏ –Ω–µ –ø–æ–¥–Ω—è—Ç, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±—É–¥–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–º, –Ω–æ —Å–∫—Ä–∏–ø—Ç –Ω–µ —É–ø–∞–¥—ë—Ç.

### üèãÔ∏è Train

–ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è (–ø—Ä–∏–º–µ—Ä, –±—ã—Å—Ç—Ä–æ, 1 —ç–ø–æ—Ö–∞):

```bash
train
```

–≠–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏ –≤ ONNX:

```bash
python -m corn_classifier.export
```

–ó–∞–ø—É—Å–∫ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ:

```bash
python -m corn_classifier.infer infer.input=path/to/image.jpg
```

## –î–µ—Ç–∞–ª–∏

–°–º. —Ä–∞–∑–¥–µ–ª—ã `configs/` –¥–ª—è –≤—Å–µ—Ö –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (hydra)
